"use strict";(self.webpackChunkgamebook_creator=self.webpackChunkgamebook_creator||[]).push([[211],{8278:function(e,t,n){n.d(t,{Z:function(){return P}});var i,a,s,o=n(9439),r=n(168),l=n(2791),c=n(6060),d=n(6031),u=n(6871),h=n(4483),m=n(3174),p=n(6697),b=n(8604),f=n(4165),x=n(5861),k=n(3272),g=n(3085),Z=n(280),T=n(3478),j=n(3099),y=n(7309),N=n(5868),E=n(184),_=d.ZP.div(i||(i=(0,r.Z)(["\n    // put some styles here\n"]))),v=function(e){var t=e.isVisible,n=e.setIsVisible,i=(0,p.T)(),a=(0,p.C)((function(e){return e.gamebook})),s=a.authorName,r=a.gamebookTitle,l=k.Z.useForm(),c=(0,o.Z)(l,1)[0],d=function(){var e=(0,x.Z)((0,f.Z)().mark((function e(t){var a,s;return(0,f.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=t.authorName,s=t.gamebookTitle,a.trim(),s.trim(),i((0,b._i)({authorName:a,gamebookTitle:s})),g.Z.success({message:"Metadata changed",description:"".concat(a,', creator of "').concat(s,'" saved.'),placement:"bottomRight"}),n(!1),c.resetFields();case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),u=function(){c.resetFields(),n(!1)};return(0,E.jsx)(_,{children:(0,E.jsx)(Z.Z,{title:"View / Edit gamebook metadata",visible:t,footer:null,onCancel:u,children:(0,E.jsxs)(k.Z,{form:c,layout:"vertical",autoComplete:"off",requiredMark:"optional",onFinish:d,initialValues:{authorName:s,gamebookTitle:r},children:[(0,E.jsx)(k.Z.Item,{label:"Author's name",name:"authorName",rules:[{required:!0,message:"Please input author's name!"},{min:N.k.AUHOR_NAME_LENGTH_MIN,message:"Name min ".concat(N.k.AUHOR_NAME_LENGTH_MIN," chars!")},{max:N.k.AUHOR_NAME_LENGTH_MAX,message:"Name max ".concat(N.k.AUHOR_NAME_LENGTH_MAX," chars")}],children:(0,E.jsx)(T.Z,{placeholder:"ex. John Doe"})}),(0,E.jsx)(k.Z.Item,{label:"Title",name:"gamebookTitle",rules:[{required:!0,message:"Please input gamebook main title!"},{min:N.k.CHAPTER_TITLE_LENGTH_MIN,message:"Name min ".concat(N.k.CHAPTER_TITLE_LENGTH_MIN," chars!")},{max:N.k.CHAPTER_TITLE_LENGTH_MAX,message:"Name max ".concat(N.k.CHAPTER_TITLE_LENGTH_MAX," chars")}],children:(0,E.jsx)(T.Z,{placeholder:"ex. New Journey of Halflings"})}),(0,E.jsx)(k.Z.Item,{style:{textAlign:"end"},children:(0,E.jsxs)(j.Z,{size:"middle",children:[(0,E.jsx)(y.Z,{onClick:u,children:"Cancel"}),(0,E.jsx)(y.Z,{type:"primary",htmlType:"submit",children:"Submit"})]})})]})})})},C=n(8425),I=n(8190),A=n(3231),H=function(e){var t=e.gamebookTitle,n=e.authorName,i=e.chapters,a="".concat(t,"\n\n");return a+="by ".concat(n,"\n\n"),a+="=========================\n\n\n",i.forEach((function(e){a+="".concat(e.chapterNumber,"\n\n"),a+="".concat(e.content,"\n\n\n\n")})),a+="END"},w=d.ZP.div(a||(a=(0,r.Z)(["\n    // put some styles here\n"]))),F=function(e){var t=e.isVisible,n=e.setIsVisible,i=(0,p.C)((function(e){return e.gamebook})),a=i.gamebookTitle,s=i.authorName,r=i.chapters,c=k.Z.useForm(),d=(0,o.Z)(c,1)[0],u=l.useState("text/plain"),h=(0,o.Z)(u,2),m=h[0],b=(h[1],function(){var e=(0,x.Z)((0,f.Z)().mark((function e(t){var i,o,l,c;return(0,f.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i="text/plain"===t.filetype?new Blob([H({gamebookTitle:a,authorName:s,chapters:r})],{type:"text/plain"}):new Blob([JSON.stringify({gamebookTitle:a,authorName:s,chapters:r})],{type:"application/json"}),o=window.URL.createObjectURL(i),l=a||"gamebook_file",(c=document.createElement("a")).download=l,c.innerHTML="Download File",c.href=o,c.onclick=function(e){document.body.removeChild(e.target)},c.style.display="none",document.body.appendChild(c),c.click(),g.Z.success({message:"Saving...",description:"File ".concat(l," by ").concat(s," saved."),placement:"bottomRight"}),n(!1);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),_=function(){d.resetFields(),n(!1)};return(0,E.jsx)(w,{children:(0,E.jsx)(Z.Z,{title:"Export to file",visible:t,footer:null,onCancel:_,children:(0,E.jsxs)(k.Z,{form:d,layout:"vertical",autoComplete:"off",requiredMark:!1,onFinish:b,initialValues:{gamebookTitle:a,filetype:m},children:[(0,E.jsx)(k.Z.Item,{label:"Filename",name:"gamebookTitle",rules:[{required:!0,message:"Please input file's name!"},{min:N.k.FILE_NAME_LENGTH_MIN,message:"Filename min ".concat(N.k.FILE_NAME_LENGTH_MIN," chars!")},{max:N.k.FILE_NAME_LENGTH_MAX,message:"Filename max ".concat(N.k.FILE_NAME_LENGTH_MAX," chars")}],children:(0,E.jsx)(T.Z,{placeholder:"ex. ".concat(a)})}),(0,E.jsx)(k.Z.Item,{label:"Filetype",name:"filetype",children:(0,E.jsxs)(A.ZP.Group,{children:[(0,E.jsx)(A.ZP,{value:"text/plain",children:"txt"}),(0,E.jsx)(A.ZP,{value:"application/json",children:"json"})]})}),(0,E.jsx)(k.Z.Item,{style:{textAlign:"end"},children:(0,E.jsxs)(j.Z,{size:"middle",children:[(0,E.jsx)(y.Z,{onClick:_,children:"Cancel"}),(0,E.jsx)(y.Z,{type:"primary",htmlType:"submit",children:"Submit"})]})})]})})})},L=d.ZP.div(s||(s=(0,r.Z)(["\n    // put some styles here\n"]))),M=[{label:"File",key:"File",disabled:!1,children:[{label:"New book",key:"newBook",icon:(0,E.jsx)(h.G,{icon:m.FL8}),disabled:!0},{label:"Oper existing",key:"openExisting",icon:(0,E.jsx)(h.G,{icon:m.cC_}),disabled:!0},{label:"Export",key:"exportBook",disabled:!1,icon:(0,E.jsx)(h.G,{icon:m.EdJ})}]},{label:"Book",key:"bookOptions",children:[{label:"Add new chapter",key:"addNewChapter",icon:(0,E.jsx)(h.G,{icon:m.b7h})},{label:"Schuffle chapters",key:"schuffleChapters",disabled:!1,icon:(0,E.jsx)(h.G,{icon:m.RJo})},{label:"Introduction",key:"introduction",disabled:!0,icon:(0,E.jsx)(h.G,{icon:m.rxY})},{label:"Metadata",key:"metadata",disabled:!1,icon:(0,E.jsx)(h.G,{icon:m.ZWV})},{label:"Statistics",key:"bookStatistics",disabled:!0,icon:(0,E.jsx)(h.G,{icon:m.OS1})}]},{label:"Html Preview",key:"previewBook",disabled:!1},{label:"Play",key:"playBook",disabled:!1},{label:"Graph",key:"graphBook",disabled:!0},{label:"About",key:"aboutApp",disabled:!0,children:[{label:"Help",key:"appHelp",disabled:!0,icon:(0,E.jsx)(h.G,{icon:m.w49})}]},{label:"DropDB",key:"dropDB",disabled:!0,danger:!0}],P=function(){var e=(0,u.s0)(),t=(0,p.T)(),n=l.useState(""),i=(0,o.Z)(n,2),a=i[0],s=i[1],r=l.useState(!1),d=(0,o.Z)(r,2),h=d[0],m=d[1],f=l.useState(!1),x=(0,o.Z)(f,2),k=x[0],g=x[1],Z=l.useState(!1),T=(0,o.Z)(Z,2),j=T[0],y=T[1],N=l.useState(!1),_=(0,o.Z)(N,2),A=_[0],H=_[1];return(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)(L,{children:(0,E.jsx)(c.Z,{onClick:function(n){switch(s(n.key),n.key){case"addNewChapter":g(!0);break;case"metadata":m(!0);break;case"schuffleChapters":y(!0);break;case"exportBook":H(!0);break;case"previewBook":e("/preview");break;case"playBook":e("/play");break;case"dropDB":t((0,b.bQ)()),e("/")}},selectedKeys:[a],mode:"horizontal",items:M})}),(0,E.jsx)(v,{isVisible:h,setIsVisible:m}),(0,E.jsx)(I.Z,{isVisible:k,setIsVisible:g}),(0,E.jsx)(C.Z,{isVisible:j,setIsVisible:y}),(0,E.jsx)(F,{isVisible:A,setIsVisible:H})]})}},8190:function(e,t,n){n.d(t,{Z:function(){return x}});var i,a=n(9439),s=n(168),o=n(3272),r=n(3085),l=n(280),c=n(3478),d=n(7309),u=(n(2791),n(6031)),h=n(6697),m=n(8604),p=n(5868),b=n(184),f=u.ZP.div(i||(i=(0,s.Z)(["\n    // put some styles here\n"]))),x=function(e){var t=e.isVisible,n=e.setIsVisible,i=o.Z.useForm(),s=(0,a.Z)(i,1)[0],u=(0,h.T)();return(0,b.jsx)(f,{children:(0,b.jsx)(l.Z,{title:"Create new Chapter",visible:t,onCancel:function(){n(!1)},footer:null,width:700,children:(0,b.jsxs)(o.Z,{form:s,autoComplete:"off",layout:"vertical",requiredMark:"optional",size:"large",onFinish:function(e){u((0,m.Xi)(e.title)),r.Z.success({message:"Chapter created",description:'Chapter "'.concat(e.title,"\" created. You can select it in chapter's tree on the left to edit it's content."),placement:"bottomRight",duration:3}),s.resetFields(),n(!1)},initialValues:{title:"New chapter very new title"},children:[(0,b.jsx)(o.Z.Item,{name:"title",rules:[{required:!0,message:"Enter the title!"},{min:p.k.CHAPTER_TITLE_LENGTH_MIN,message:"Min length ".concat(p.k.CHAPTER_TITLE_LENGTH_MIN," chars!")},{max:p.k.CHAPTER_TITLE_LENGTH_MAX,message:"Max length ".concat(p.k.CHAPTER_TITLE_LENGTH_MAX," chars!")}],children:(0,b.jsx)(c.Z,{placeholder:"ex. Entering dungeon's kitchen"})}),(0,b.jsx)(o.Z.Item,{style:{textAlign:"end"},children:(0,b.jsx)(d.Z,{htmlType:"submit",children:"Create chapter"})})]})})})}},8425:function(e,t,n){n.d(t,{Z:function(){return f}});var i,a=n(168),s=n(9964),o=n(3085),r=n(280),l=n(3099),c=n(7309),d=(n(2791),n(8604)),u=n(6697),h=n(6031),m=n(184),p=h.ZP.div(i||(i=(0,a.Z)(["\n    // put some styles here\n"]))),b=s.Z.Text,f=function(e){var t=e.isVisible,n=e.setIsVisible,i=(0,u.T)(),a=function(){n(!1)};return(0,m.jsx)(p,{children:(0,m.jsxs)(r.Z,{title:"Schuffle chapters",visible:t,onCancel:a,footer:null,children:[(0,m.jsx)(b,{children:"Do you really want to shuffle chapters?"}),(0,m.jsx)("div",{style:{textAlign:"end"},children:(0,m.jsxs)(l.Z,{size:"middle",children:[(0,m.jsx)(c.Z,{onClick:a,children:"Cancel"}),(0,m.jsx)(c.Z,{onClick:function(){i((0,d.FE)()),o.Z.success({message:"Shuffled chapters",description:"Chapters shuffled.",placement:"bottomRight"}),n(!1)},style:{color:"#fa8c16",borderColor:"#fa8c16"},children:"Shuffle"})]})})]})})}},8211:function(e,t,n){n.r(t),n.d(t,{default:function(){return E}});var i,a=n(168),s=n(6106),o=n(914),r=n(3433),l=n(9439),c=n(2791),d=n(6031),u=n(6697),h=n(2810),m=n(6015),p=n(5868),b=n(184),f=d.ZP.div(i||(i=(0,a.Z)(["\n    // put some styles here\n    height: 100%;\n    padding: 10px;\n    .graph-container {\n        background-color: #222;\n        height: 100%;\n        border: 1px solid #444;\n    }\n"]))),x={nodes:[],edges:[]},k={layout:{hierarchical:!1,randomSeed:321},edges:{color:"#FFFFFF",smooth:!0},nodes:{shape:"box"},height:"100%",width:"100%"},g={select:function(e){e.nodes,e.edges}};function Z(e){return e.id===p.k.FIRST_CHAPTER_ID?"blue":"white"}var T,j=function(){var e=(0,u.C)((function(e){return e.gamebook})),t=e.chapters,n=(e.selectedId,c.useState(x)),i=(0,l.Z)(n,2),a=i[0],s=i[1];return c.useEffect((function(){var e=t.map((function(e){return e.id})),n=t.map((function(n){var i,a,s=null===(i=n.content)||void 0===i||null===(a=i.match(/(\d+)/g))||void 0===a?void 0:a.map((function(e){return parseInt(e)}));return null===s||void 0===s?void 0:s.map((function(i){return i>0&&i<t.length?{from:n.id,to:e[i-1]}:{from:n.id,to:"NO_CHAPTER"}}))})).flat();s({nodes:[].concat((0,r.Z)(t.map((function(e){return{id:e.id,label:"".concat(e.chapterNumber," ").concat(e.title.slice(0,10)),title:"".concat(e.chapterNumber," ").concat(e.title.slice(0,10)),color:Z(e)}}))),[{id:"NO_CHAPTER",label:"NO CHAPTER",title:"NO CHAPTER",color:"red"}]),edges:(0,r.Z)(n)})}),[t]),(0,b.jsx)(f,{children:(0,b.jsx)("div",{className:"graph-container",children:(0,b.jsx)(m.Z,{graph:a,options:k,events:g},(0,h.Z)())})})},y=n(8278),N=d.ZP.div(T||(T=(0,a.Z)(["\n    // put some styles here\n    height: 100vh;\n    .graph-big_page-container {\n        height: calc(100% - 70px);\n        width: 100%;\n    }\n    .graph-big_tree-container {\n        width: 100%;\n    }\n"]))),E=function(){return(0,b.jsxs)(N,{children:[(0,b.jsx)(y.Z,{}),(0,b.jsx)(s.Z,{className:"graph-big_page-container",children:(0,b.jsx)(o.Z,{className:"graph-big_tree-container",children:(0,b.jsx)(j,{})})})]})}},6697:function(e,t,n){n.d(t,{C:function(){return s},T:function(){return a}});var i=n(9434),a=function(){return(0,i.I0)()},s=i.v9}}]);
//# sourceMappingURL=211.ea6b3705.chunk.js.map